<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Edit recipe</title>
    <link rel="stylesheet" href="/style.css">
</head>
<body>
    <div class="edit">
        <h2>Edit Recipe</h2>

        <form id="edit-form">
            <input type="text" id="title" placeholder="title"><br>
            <textarea id="description" placeholder="description"></textarea><br>
            <textarea id="ingredients" placeholder="ingredients"></textarea><br>
            <textarea id="instructions" placeholder="instructions"></textarea><br>

            <button type="submit">Save</button>

        </form>
    </div>
<script>
    const params = new URLSearchParams(window.location.search);
    const Id = params.get('id');

    fetch('/api/recipes/' + Id)
    .then(response => response.json())
    .then(r => {
        document.getElementById('title').value = r.title;
        document.getElementById('description').value = r.description;
        document.getElementById('ingredients').value = r.ingredients;
        document.getElementById('instructions').value = r.instructions;
    });

    document.getElementById("edit-form").addEventListener('submit', (e)=> {
        e.preventDefault();

        fetch('/api/recipes/' + Id, {
            method: 'PUT',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({
                title: title.value,
                description: description.value,
                ingredients: ingredients.value,
                instructions: instructions.value
            })
        })
        .then(res => res.json())
        .then(() => {
            alert("saved successfully");
            window.location.href = '/profile/profile.html';
        });
    });
</script>
    

</body>
</html>